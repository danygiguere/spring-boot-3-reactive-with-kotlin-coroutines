### Docker
    - This project has a Dockerfile and a docker-compose.yml for deployement on AWS ECS
    - To test locally, you can add the credentials in the .env file and run docker-compose up

## AWS Deployment

### ASW ECS (Serverless Fargate) instructions
    - Make sure you have the AWS CLI installed on your machine
    - run gradle clean build or ./gradlew clean build -x test
    - to build the image, run docker buildx build --no-cache --pull --platform linux/amd64 -t imagename . 
    - Create an ECR repository and look at the instructions (by clicking on the view push commands button) to push the image to ECR 
        - docker buildx build --no-cache --pull --platform linux/amd64 -t imagename . 
        - aws ecr get-login-password --region us-east-1 | docker login --username AWS --password-stdin 123456789012.dkr.ecr.us-east-1.amazonaws.com
        - docker tag imagename:latest 123456789012.dkr.ecr.us-east-1.amazonaws.com/imagename:latest
        - docker push 123456789012.dkr.ecr.us-east-1.amazonaws.com/imagename:latest
    - Create a task definition in ECS
        - https://docs.aws.amazon.com/AmazonECS/latest/developerguide/task_definitions.html
        - Basically, you need to enter a name, the image url (from ECR), the app port and the Environment variables (the ones in the .env)
    - Create a cluster in ECS
        - https://docs.aws.amazon.com/AmazonECS/latest/developerguide/create-a-cluster.html
        - The name is automatically generated by the ECS service, so you only need to click create cluster and then click create.

### Using Application Load Balancer with a Static IP for Angular and Spring Boot Apps
    1. Create an Application Load Balancer:
        - Go to the EC2 Dashboard in the AWS Console
        - In the left navigation pane, under Load Balancing, click "Load Balancers"
        - Click "Create Load Balancer"
        - Select "Application Load Balancer" and click "Create"
        - Configure the load balancer:
            - Name: Give your load balancer a name
            - Scheme: Select "internet-facing"
            - IP address type: Select "ipv4"
            - VPC: Select the same VPC as your ECS cluster
            - Mappings: Select at least two subnets in different Availability Zones
        - Configure security settings (add HTTPS if needed)
        - Configure security groups to allow traffic on ports 80 and 8080
        - Configure routing:
            - Create two target groups (you need to enter the health check path for each):
                1. For Angular app (HTTP:80)
                2. For Spring Boot app (HTTP:8080)
        - Configure listeners:
            - Add a listener for HTTP:80 pointing to the Angular target group
            - Create a rule to forward requests with path pattern `/api/*` to the Spring Boot target group
            - Create a default rule to forward all other requests to the Angular target group
        - Create the load balancer

  
    2. Create a Service for each application in ECS:
        - Go to the ECS Dashboard in the AWS Console
        - Click on your cluster
        - Click "Create" under the Services tab
        - Choose "Fargate" as the launch type
        - Select the task definition you created for your Angular app
        - Configure the service:
            - Number of tasks: Set the desired number of tasks
            - Load balancing: Select "Application Load Balancer"
            - Choose the load balancer you created
            - Select the target group for the Angular app
            - Set container to port mapping to 80
        - For the spring boot app, select the listeners HTTP:80 and the container port to 8080, ant the Target group to the spring boot target group
   
    3. Then to deploy, you can go into the ECS survice and click on update, then force new deployment.